import os
import zipfile
import glob

root_folder = os.getcwd()
zip_files = glob.glob(os.path.join(root_folder, '*.zip'))

# Create temp folder if it doesn't exist
temp_folder = os.path.join(root_folder, 'temp')
if not os.path.exists(temp_folder):
    os.makedirs(temp_folder)

# Extract zip files to temp folder
for zip_file in zip_files:
    with zipfile.ZipFile(zip_file, 'r') as zip_ref:
        zip_ref.extractall(temp_folder)

# Rename csv files and remove first line
csv_files = glob.glob(os.path.join(temp_folder, '*.csv'))
for i, csv_file in enumerate(csv_files):
    new_name = os.path.join(temp_folder, f"{i+1}-{os.path.basename(csv_file)}")
    os.rename(csv_file, new_name)
    
    with open(new_name, 'r') as f:
        lines = f.readlines()
    
    with open(new_name, 'w') as f:
        if i == 0:
            f.writelines(lines)
        else:
            f.writelines(lines[1:])

# Join all csv files into report_final.csv
with open(os.path.join(root_folder, 'report_final.csv'), 'w') as report_file:
    for csv_file in csv_files:
        with open(csv_file, 'r') as f:
            report_file.write(f.read())
